# UI-003 ユーザー詳細画面

## 画面概要
ユーザー情報の詳細を表示する画面（読み取り専用）


## 画面URL
`/users/{id}`

## ボタン・機能のビジネスロジック

### 1. ✏️ 編集ボタン
| 項目 | 内容 |
|------|------|
| **処理内容** | ユーザー編集画面へ遷移 |
| **メソッド** | GET |
| **遷移先** | /users/{id}/edit |

### 2. 🗑️ 削除ボタン
| 項目 | 内容 |
|------|------|
| **処理内容** | 削除確認ダイアログ表示 → 削除実行 |
| **メソッド** | POST |
| **エンドポイント** | /users/{id}/delete |
| **成功時** | `user.delete.success`「ユーザーが削除されました」→ 一覧画面へリダイレクト |
| **エラー時** | `delete.cannot.related.data`「このユーザーは削除できません。関連データが存在します。」 |

### 3. ⬅️ 戻るボタン
| 項目 | 内容 |
|------|------|
| **処理内容** | 一覧画面へ遷移 |
| **メソッド** | GET |
| **遷移先** | /users |

### 4. スキル追加ボタン
| 項目 | 内容 |
|------|------|
| **処理内容** | スキル追加フォームを表示（Alpine.js） |
| **表示制御** | クリック時にフォームを展開表示 |
| **フォーム項目** | スキル名（必須）、レベル（0-5）、経験年数、備考 |
| **送信メソッド** | POST（HTMX） |
| **エンドポイント** | /users/{userId}/skills |
| **バリデーション** | スキル名重複チェック |
| **成功時** | スキル一覧を部分更新（ページリロードなし） |
| **エラー時** | `skill.already.exists`「このスキルは既に登録されています。」|

#### 4-1. 追加ボタン（フォーム内）
| 項目 | 内容 |
|------|------|
| **処理内容** | スキル情報を送信 |
| **バリデーション** | スキル名必須チェック、重複チェック |
| **成功時** | フォームをリセット、非表示化、スキル一覧更新 |

#### 4-2. キャンセルボタン（フォーム内）
| 項目 | 内容 |
|------|------|
| **処理内容** | スキル追加フォームを非表示化 |
| **表示制御** | Alpine.js（`@click="showAddSkill = false"`） |
| **データ処理** | 入力内容は破棄（送信なし） |

### 5. スキル削除ボタン（各スキル行）
| 項目 | 内容 |
|------|------|
| **処理内容** | 該当スキルを論理削除 |
| **確認ダイアログ** | 「このスキルを削除してもよろしいですか？」|
| **メソッド** | POST（HTMX） |
| **エンドポイント** | /users/{userId}/skills/{skillId}/delete |
| **成功時** | スキル一覧を部分更新（ページリロードなし） |
| **エラー時** | `skill.delete.error`「スキルの削除に失敗しました」|

## 表示項目

| カテゴリー | 表示内容 |
|------------|----------|
| **基本情報** | ユーザーID、ユーザー名、メールアドレス、電話番号 |
| **分類情報** | カテゴリー、ステータス、タグ（カンマ区切り） |
| **その他** | メルマガ同意状態、登録日時、更新日時 |
| **スキル情報** | スキル一覧テーブル（動的更新可能） |
| ├ スキル名 | 各スキルの名称 |
| ├ レベル | 0-5の段階表示（バッジ形式） |
| ├ 経験年数 | 年数または「-」表示 |
| ├ 備考 | 追加情報または「-」表示 |
| ├ 登録日 | yyyy/MM/dd形式 |
| └ 操作 | 削除ボタン（各行） |

## エラーハンドリング

| エラー種別 | メッセージ |
|------------|-----------|
| **ユーザー不存在** | `user.not.found.general`「ユーザーが見つかりません」→ 一覧へリダイレクト |
| **データ取得失敗** | `user.detail.error`「ユーザー詳細の取得に失敗しました」 |
| **スキル重複** | `skill.already.exists`「このスキルは既に登録されています。」|
| **スキル追加失敗** | `skill.add.error`「スキルの追加に失敗しました」 |
| **スキル削除失敗** | `skill.delete.error`「スキルの削除に失敗しました」 |
| **DB接続エラー** | `database.connection.error`「データベースへの接続に失敗しました。しばらく待ってから再度お試しください。」 |

## 技術実装メモ

### 動的UI実装
- **HTMX**: スキルの追加・削除時の部分更新（ページリロードなし）
- **Alpine.js**: スキル追加フォームの表示/非表示制御
- **Fragment更新**: `skills-fragment.html`を使用した部分レンダリング
- **重複チェック**: コントローラーレベルでスキル名の事前検証を実施