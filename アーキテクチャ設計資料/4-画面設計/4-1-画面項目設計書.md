# 画面項目定義書（DB整合版：Entry機能）

---

## 1. 登録画面（Create）※DB整合
| No. | 項目名            | 種別     | 桁数 / 形式               | 必須 | 保存先列            | 制約・特性                                    | 備考     |
|----:|-------------------|----------|---------------------------|:---:|---------------------|-----------------------------------------------|----------|
| 1   | name              | 文字列   | 最大50文字                | ○   | entries.name        | 前後空白除去                                   | 入力     |
| 2   | email             | 文字列   | メール形式 / 最大255文字   | ○   | entries.email       | 一意制約（ux_entries_email）                   | 入力     |
| 3   | category          | 列挙型   | categories.name           | ○   | entries.category_id | プルダウン選択／値は `categories.id` を保存    | 入力     |
| 4   | status            | 列挙型   | statuses.name             | ○   | entries.status_id   | ラジオ/プルダウン／値は `statuses.id` を保存   | 入力     |
| 5   | tags              | 複数選択 | 0〜4個（tags.label/code） | -   | entry_tags.*        | 選択したタグを `entry_tags(entry_id, tag_id)` で保存 | 入力     |
| 6   | 同意（ニュースレター） | 真偽値   | チェックボックス            | -   | entries.agree_newsletter | 未入力時は FALSE（DB既定）               | 入力     |

> 除外：`id / created_at / updated_at` はDB自動設定のため本画面には非表示。

---

## 2. 一覧画面（List）
| No. | 項目名              | 種別   | 形式/桁         | 必須 | 参照列                                   | 制約・特性                          | 備考     |
|----:|---------------------|--------|-----------------|:---:|------------------------------------------|-------------------------------------|----------|
| 1   | id                  | 数値   | -               | -   | entries.id                               | ソート・参照キー                    | 表示     |
| 2   | name                | 文字列 | 最大50          | -   | entries.name                             | -                                   | 表示     |
| 3   | email               | 文字列 | 最大255/メール   | -   | entries.email                            | -                                   | 表示     |
| 4   | category            | 文字列 | -               | -   | categories.name (INNER JOIN)             | -                                   | 表示     |
| 5   | status              | 文字列 | -               | -   | statuses.name (INNER JOIN)               | -                                   | 表示     |
| 6   | 作成日時            | 日時   | yyyy-MM-dd HH:mm:ss | - | entries.created_at                       | -                                   | 表示     |
| 7   | 更新日時            | 日時   | yyyy-MM-dd HH:mm:ss | - | entries.updated_at                       | 既定ソート：降順                    | 表示     |
| 8   | タグ件数（任意）     | 数値   | 0〜             | -   | 集約 entry_tags (LEFT OUTER JOIN)        | タグ0件も考慮                        | 表示可   |
| 9   | 最新ノート（任意）   | 文字列 | 一部表示        | -   | notes.body 最新1件 (LEFT OUTER JOIN)     | 未登録行あり                         | 表示可   |

---

## 3. 詳細画面（Detail）
| No. | 項目名            | 種別   | 形式/桁                 | 必須 | 参照列                                   | 制約・特性             | 備考     |
|----:|-------------------|--------|-------------------------|:---:|------------------------------------------|------------------------|----------|
| 1   | id                | 数値   | -                       | -   | entries.id                               | 参照キー               | 表示のみ |
| 2   | name              | 文字列 | 最大50                  | -   | entries.name                             | -                      | 表示のみ |
| 3   | email             | 文字列 | 最大255/メール          | -   | entries.email                            | -                      | 表示のみ |
| 4   | category          | 文字列 | -                       | -   | categories.name (INNER JOIN)             | -                      | 表示のみ |
| 5   | status            | 文字列 | -                       | -   | statuses.name (INNER JOIN)               | -                      | 表示のみ |
| 6   | tags              | 配列   | 0〜4                    | -   | tags.label（entry_tags 経由）            | カンマ区切り表示など    | 表示のみ |
| 7   | 同意（ニュースレター） | 真偽値 | true/false             | -   | entries.agree_newsletter                 | -                      | 表示のみ |
| 8   | 作成日時          | 日時   | yyyy-MM-dd HH:mm:ss     | -   | entries.created_at                        | -                      | 表示のみ |
| 9   | 更新日時          | 日時   | yyyy-MM-dd HH:mm:ss     | -   | entries.updated_at                        | -                      | 表示のみ |
|10   | 最新ノート（任意） | 文字列 | -                       | -   | notes.body 最新1件 (LEFT OUTER JOIN)     | 未登録行あり            | 表示可   |

---

## 4. 更新画面（Update/Edit）
| No. | 項目名            | 種別     | 桁数 / 形式               | 必須 | 保存先列            | 制約・特性                                         | 備考     |
|----:|-------------------|----------|---------------------------|:---:|---------------------|----------------------------------------------------|----------|
| 0   | id（非活性）       | 数値     | -                         | -   | entries.id          | 変更不可                                            | 表示のみ |
| 1   | name              | 文字列   | 最大50文字                | ○   | entries.name        | 前後空白除去                                        | 入力     |
| 2   | email             | 文字列   | メール形式 / 最大255文字   | ○   | entries.email       | 一意制約（自レコード除外で検証）                   | 入力     |
| 3   | category          | 列挙型   | categories.name           | ○   | entries.category_id | プルダウン／値は `categories.id` を保存            | 入力     |
| 4   | status            | 列挙型   | statuses.name             | ○   | entries.status_id   | ラジオ/プルダウン／値は `statuses.id` を保存       | 入力     |
| 5   | tags              | 複数選択 | 0〜4個（tags.label/code） | -   | entry_tags.*        | `entry_tags` を差分更新（追加/削除）               | 入力     |
| 6   | 同意（ニュースレター） | 真偽値   | チェックボックス            | -   | entries.agree_newsletter | 未入力時は FALSE維持（DB既定）               | 入力     |
| 7   | 作成日時          | 日時     | yyyy-MM-dd HH:mm:ss       | -   | entries.created_at  | 表示のみ                                           | 表示のみ |
| 8   | 更新日時          | 日時     | yyyy-MM-dd HH:mm:ss       | -   | entries.updated_at  | 保存後に自動更新                                    | 表示のみ |

---

## 5. 削除確認（Dialog）
| No. | 項目名   | 種別 | 形式 | 必須 | 参照/保存先 | 制約・特性                     | 備考   |
|----:|----------|------|------|:---:|-------------|-------------------------------|--------|
| 1   | id       | 数値 | -    | ○   | entries.id  | 対象レコード識別子             | 非入力 |
| 2   | サマリ   | 文字 | -    | -   | name/email  | 確認用表示                     | 表示   |
| 3   | 確認操作 | 操作 | Yes/No | ○ | -           | YesでDELETE、Noでキャンセル     | 操作   |

### 共通
- バリデーション：`name ≤ 50`、`email ≤ 255 & 形式 & 一意`、`category/status 必須`、`tags 0〜4`  
- JOIN方針：`categories/statuses` は **INNER**、`tags/notes` は **LEFT OUTER**  
- 監査：重要操作/例外は `audit_logs` に記録（機密除外）。
