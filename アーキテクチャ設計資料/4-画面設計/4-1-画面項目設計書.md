# 4-1-画面項目定義書

---

## 1. 登録画面（Create）

**Figma:** [ユーザー登録画面](https://www.figma.com/design/lcx0lgiGb4NI2twqNbw5Hz/%E7%99%BB%E9%8C%B2%E7%94%BB%E9%9D%A2?node-id=1-69&t=4KovVi4ONfXEyECC-1)

### 1.1 入力項目仕様

| No. | 項目名            | 種別     | 桁数 / 形式               | 必須 | 保存先列            | 制約・特性                                    | 備考     |
|----:|-------------------|----------|---------------------------|:---:|---------------------|-----------------------------------------------|----------|
| 1   | name              | 文字列   | 最大50文字                | ○   | entries.name        | 前後空白除去                                   | 入力     |
| 2   | email             | 文字列   | メール形式 / 最大255文字   | ○   | entries.email       | 一意制約（ux_entries_email）                   | 入力     |
| 3   | category          | 列挙型   | categories.name           | ○   | entries.category_id | プルダウン選択／値は `categories.id` を保存    | 入力     |
| 4   | status            | 列挙型   | statuses.name             | ○   | entries.status_id   | ラジオ/プルダウン／値は `statuses.id` を保存   | 入力     |
| 5   | tags              | 複数選択 | 0〜4個（tags.label/code） | -   | entry_tags.*        | 選択したタグを `entry_tags(entry_id, tag_id)` で保存<br>スキル領域チェックボックス：最大4個まで選択可能<br>4個選択時は残りのチェックボックスを無効化 | 入力     |
| 6   | 同意（ニュースレター） | 真偽値   | チェックボックス            | -   | entries.agree_newsletter | 未入力時は FALSE（DB既定）               | 入力     |

### 1.2 ボタン仕様

| No. | ボタン名 | 種別 | 処理内容 | 遷移先 | 制約・特性 | 備考 |
|----:|----------|------|----------|--------|------------|------|
| 1   | UI-001.登録する | 送信 | バリデーション → DB登録 | /users | 全項目バリデーション後実行 | primary |
| 2   | UI-001.キャンセル | 遷移 | 入力内容破棄 | /users | 確認なし遷移 | secondary |
| 3   | UI-001.スキル追加 | 動的 | スキル入力欄追加 | - | 最大10件まで | outline |

> 除外：`id / created_at / updated_at` はDB自動設定のため本画面には非表示。

---

## 2. 一覧画面（List）

**Figma:** [ユーザー一覧画面](https://www.figma.com/design/WRBGXISTxxqbsRfMhlK8cF/%E4%B8%80%E8%A6%A7%E7%94%BB%E9%9D%A2.?node-id=1-299&t=g8VKbY7Z8EceEGmD-1)

### 2.1 表示項目仕様

| No. | 項目名              | 種別   | 形式/桁         | 必須 | 参照列                                   | 制約・特性                          | 備考     |
|----:|---------------------|--------|-----------------|:---:|------------------------------------------|-------------------------------------|----------|
| 1   | id                  | 数値   | -               | -   | entries.id                               | ソート・参照キー                    | 表示     |
| 2   | name                | 文字列 | 最大50          | -   | entries.name                             | -                                   | 表示     |
| 3   | email               | 文字列 | 最大255/メール   | -   | entries.email                            | -                                   | 表示     |
| 4   | category            | 文字列 | -               | -   | categories.name (INNER JOIN)             | -                                   | 表示     |
| 5   | status              | 文字列 | -               | -   | statuses.name (INNER JOIN)               | -                                   | 表示     |
| 6   | 作成日時            | 日時   | yyyy-MM-dd HH:mm:ss | - | entries.created_at                       | -                                   | 表示     |
| 7   | 更新日時            | 日時   | yyyy-MM-dd HH:mm:ss | - | entries.updated_at                       | 既定ソート：降順                    | 表示     |
| 8   | タグ件数（任意）     | 数値   | 0〜             | -   | 集約 entry_tags (LEFT OUTER JOIN)        | タグ0件も考慮                        | 表示可   |
| 9   | 最新ノート（任意）   | 文字列 | 一部表示        | -   | notes.body 最新1件 (LEFT OUTER JOIN)     | 未登録行あり                         | 表示可   |

### 2.2 ボタン仕様

| No. | ボタン名 | 種別 | 処理内容 | 遷移先 | 制約・特性 | 備考 |
|----:|----------|------|----------|--------|------------|------|
| 1   | UI-002.新規登録 | 遷移 | 登録画面へ遷移 | /users/new | - | primary |
| 2   | UI-002.検索 | 検索 | 検索条件でフィルタ | /users | 部分一致検索 | primary |
| 3   | UI-002.詳細（各行） | 遷移 | 詳細画面へ遷移 | /users/{id} | 対象レコードのID必須 | link |
| 4   | UI-002.編集（各行） | 遷移 | 編集画面へ遷移 | /users/{id}/edit | 対象レコードのID必須 | link |

---

## 3. 詳細画面（Detail）

**Figma:** [ユーザー詳細画面](https://www.figma.com/design/hsM0ggwqDIZW14ABCU0p7g/%E8%A9%B3%E7%B4%B0%E7%94%BB%E9%9D%A2?node-id=0-1&t=Jl9zY3HlrAw54IqZ-1)

### 3.1 表示項目仕様

| No. | 項目名            | 種別   | 形式/桁                 | 必須 | 参照列                                   | 制約・特性             | 備考     |
|----:|-------------------|--------|-------------------------|:---:|------------------------------------------|------------------------|----------|
| 1   | id                | 数値   | -                       | -   | entries.id                               | 参照キー               | 表示のみ |
| 2   | name              | 文字列 | 最大50                  | -   | entries.name                             | -                      | 表示のみ |
| 3   | email             | 文字列 | 最大255/メール          | -   | entries.email                            | -                      | 表示のみ |
| 4   | category          | 文字列 | -                       | -   | categories.name (INNER JOIN)             | -                      | 表示のみ |
| 5   | status            | 文字列 | -                       | -   | statuses.name (INNER JOIN)               | -                      | 表示のみ |
| 6   | tags              | 配列   | 0〜4                    | -   | tags.label（entry_tags 経由）            | カンマ区切り表示など    | 表示のみ |
| 7   | 同意（ニュースレター） | 真偽値 | true/false             | -   | entries.agree_newsletter                 | -                      | 表示のみ |
| 8   | 作成日時          | 日時   | yyyy-MM-dd HH:mm:ss     | -   | entries.created_at                        | -                      | 表示のみ |
| 9   | 更新日時          | 日時   | yyyy-MM-dd HH:mm:ss     | -   | entries.updated_at                        | -                      | 表示のみ |
|10   | 最新ノート（任意） | 文字列 | -                       | -   | notes.body 最新1件 (LEFT OUTER JOIN)     | 未登録行あり            | 表示可   |

### 3.2 ボタン仕様

| No. | ボタン名 | 種別 | 処理内容 | 遷移先 | 制約・特性 | 備考 |
|----:|----------|------|----------|--------|------------|------|
| 1   | UI-003.編集 | 遷移 | 編集画面へ遷移 | /users/{id}/edit | 対象レコード存在確認 | primary |
| 2   | UI-003.削除 | 確認 | 削除確認ダイアログ表示 | - | 削除確認モーダル表示 | danger |
| 3   | UI-003.戻る | 遷移 | 一覧画面へ遷移 | /users | - | secondary |

---

## 4. 更新画面（Update/Edit）

**Figma:** [ユーザー更新画面](https://www.figma.com/design/UdoValFnaFk1MB95TfiqC4/%E6%9B%B4%E6%96%B0%E7%94%BB%E9%9D%A2?node-id=1-75&t=Fa8RJBV4jzFBxf4e-1)

### 4.1 入力項目仕様

| No. | 項目名            | 種別     | 桁数 / 形式               | 必須 | 保存先列            | 制約・特性                                         | 備考     |
|----:|-------------------|----------|---------------------------|:---:|---------------------|----------------------------------------------------|----------|
| 0   | id（非活性）       | 数値     | -                         | -   | entries.id          | 変更不可                                            | 表示のみ |
| 1   | name              | 文字列   | 最大50文字                | ○   | entries.name        | 前後空白除去                                        | 入力     |
| 2   | email             | 文字列   | メール形式 / 最大255文字   | ○   | entries.email       | 一意制約（自レコード除外で検証）                   | 入力     |
| 3   | category          | 列挙型   | categories.name           | ○   | entries.category_id | プルダウン／値は `categories.id` を保存            | 入力     |
| 4   | status            | 列挙型   | statuses.name             | ○   | entries.status_id   | ラジオ/プルダウン／値は `statuses.id` を保存       | 入力     |
| 5   | tags              | 複数選択 | 0〜4個（tags.label/code） | -   | entry_tags.*        | `entry_tags` を差分更新（追加/削除）               | 入力     |
| 6   | 同意（ニュースレター） | 真偽値   | チェックボックス            | -   | entries.agree_newsletter | 未入力時は FALSE維持（DB既定）               | 入力     |
| 7   | 作成日時          | 日時     | yyyy-MM-dd HH:mm:ss       | -   | entries.created_at  | 表示のみ                                           | 表示のみ |
| 8   | 更新日時          | 日時     | yyyy-MM-dd HH:mm:ss       | -   | entries.updated_at  | 保存後に自動更新                                    | 表示のみ |

### 4.2 ボタン仕様

| No. | ボタン名 | 種別 | 処理内容 | 遷移先 | 制約・特性 | 備考 |
|----:|----------|------|----------|--------|------------|------|
| 1   | UI-004.更新する | 送信 | バリデーション → DB更新 | /users/{id} | 全項目バリデーション後実行 | primary |
| 2   | UI-004.キャンセル | 遷移 | 変更内容破棄 | /users/{id} | 確認なし遷移 | secondary |
| 3   | UI-004.スキル追加 | 動的 | スキル入力欄追加 | - | 最大10件まで | outline |

---

## 5. 削除確認（Dialog）

**Figma:** [ユーザー削除確認画面](https://www.figma.com/design/a0cmLwOQkP6qyCBJ3IdlSw/%E5%89%8A%E9%99%A4%E7%A2%BA%E8%AA%8D?node-id=1-31&t=jFk2ihuuITIOZ8tN-1)

### 5.1 確認項目仕様

| No. | 項目名   | 種別 | 形式 | 必須 | 参照/保存先 | 制約・特性                     | 備考   |
|----:|----------|------|------|:---:|-------------|-------------------------------|--------|
| 1   | id       | 数値 | -    | ○   | entries.id  | 対象レコード識別子             | 非入力 |
| 2   | サマリ   | 文字 | -    | -   | name/email  | 確認用表示                     | 表示   |
| 3   | 確認操作 | 操作 | Yes/No | ○ | -           | YesでDELETE、Noでキャンセル     | 操作   |

### 5.2 ボタン仕様

| No. | ボタン名 | 種別 | 処理内容 | 遷移先 | 制約・特性 | 備考 |
|----:|----------|------|----------|--------|------------|------|
| 1   | UI-005.削除する | 削除 | 論理削除実行 | /users | 関連データも削除 | danger |
| 2   | UI-005.キャンセル | 遷移 | 削除中止 | /users/{id} | 呼び出し元へ戻る | secondary |

### 共通バリデーション
- ユーザー名：最大50文字
- メールアドレス：最大255文字、メール形式、重複不可
- カテゴリー・ステータス：必須選択
- タグ：最大4個まで選択可能
